<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backworks Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/reactflow@11/dist/index.umd.js"></script>
    <style>
        :root {
            --bg-color: #0f0f0f;
            --text-color: #ffffff;
            --card-bg: #1a1a1a;
            --border-color: #333;
            --hover-color: #222;
            --sidebar-bg: #1a1a1a;
            --main-bg: #111;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: 60px 1fr;
            height: 100vh;
        }

        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        .status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #00ff00;
        }

        .sidebar {
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px;
        }

        .nav-item {
            padding: 12px 16px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .nav-item:hover {
            background: #333;
        }

        .nav-item.active {
            background: #667eea;
        }

        .main-content {
            padding: 20px;
            overflow-y: auto;
            background: var(--main-bg);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .metric-title {
            font-size: 14px;
            color: #888;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #fff;
        }

        .metric-change {
            font-size: 12px;
            margin-top: 5px;
        }

        .metric-change.positive {
            color: #00ff88;
        }

        .metric-change.negative {
            color: #ff4444;
        }

        .chart-container {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #333;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            margin-bottom: 20px;
            color: #fff;
        }

        .endpoint-list {
            background: #1a1a1a;
            border-radius: 12px;
            border: 1px solid #333;
            overflow: hidden;
        }

        .endpoint-item {
            padding: 16px 20px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .endpoint-item:last-child {
            border-bottom: none;
        }

        .endpoint-method {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }

        .method-get {
            background: #00aa44;
        }

        .method-post {
            background: #0066cc;
        }

        .method-put {
            background: #ff8800;
        }

        .method-delete {
            background: #cc0000;
        }

        .endpoint-path {
            margin-left: 12px;
            font-family: monospace;
        }

        .endpoint-stats {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #888;
        }

        .architecture-view {
            height: 600px;
            background: #1a1a1a;
            border-radius: 12px;
            border: 1px solid #333;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #888;
        }

        .endpoints-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .endpoint-item {
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .endpoint-item:hover {
            background-color: #222;
        }

        .endpoint-item.selected {
            background-color: #2a2a2a;
            border-left: 3px solid #667eea;
        }

        .error {
            background: #cc0000;
            color: white;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .endpoint-filter input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.25);
        }
        
        .endpoints-container {
            transition: grid-template-columns 0.3s ease;
        }
        
        .endpoint-tab {
            transition: all 0.2s ease;
        }
        
        .endpoint-tab:hover {
            background-color: rgba(102, 126, 234, 0.1);
        }
        
        button {
            transition: all 0.2s ease;
        }
        
        button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .method-patch {
            background: #9C27B0;
        }
        
        .method-options {
            background: #795548;
        }
        
        .method-head {
            background: #607D8B;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .connecting {
            animation: pulse 2s infinite;
        }
        
        .insights-list div:hover {
            background-color: #222 !important;
        }
        
        .header-actions button:hover {
            background: rgba(255,255,255,0.2) !important;
        }
        
        .nav-buttons button:hover {
            background: rgba(255,255,255,0.1) !important;
            color: #fff !important;
        }
        
        /* Notification styles */
        .notification-panel {
            position: absolute;
            top: 60px;
            right: 20px;
            width: 350px;
            background: var(--panel-bg, #1a1a1a);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 100;
            border: 1px solid var(--border-color, #333);
            overflow: hidden;
            transition: all 0.2s ease;
            max-height: 500px;
            display: none;
        }
        
        .notification-panel.show {
            display: block;
        }
        
        .notification-panel-header {
            padding: 15px;
            background: var(--panel-header-bg, #222);
            border-bottom: 1px solid var(--border-color, #333);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-panel-content {
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .notification-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .clear-all-btn {
            padding: 4px 8px;
            font-size: 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid #444;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
        }
        
        .notification-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .notification-item {
            display: flex;
            padding: 12px;
            background: var(--notification-bg, #222);
            border-radius: 8px;
            border-left: 4px solid #667eea;
            position: relative;
        }
        
        .notification-item.success {
            border-left-color: #00cc66;
        }
        
        .notification-item.error {
            border-left-color: #ff4444;
        }
        
        .notification-item.warning {
            border-left-color: #ffbb33;
        }
        
        .notification-item.info {
            border-left-color: #33b5e5;
        }
        
        .notification-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            margin-right: 10px;
            font-size: 16px;
            border-radius: 50%;
        }
        
        .notification-item.success .notification-icon {
            color: #00cc66;
        }
        
        .notification-item.error .notification-icon {
            color: #ff4444;
        }
        
        .notification-item.warning .notification-icon {
            color: #ffbb33;
        }
        
        .notification-item.info .notification-icon {
            color: #33b5e5;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .notification-message {
            font-size: 13px;
            margin-bottom: 6px;
            color: var(--text-color, #ddd);
            opacity: 0.9;
        }
        
        .notification-time {
            font-size: 11px;
            color: var(--muted-text, #999);
        }
        
        .notification-close {
            position: absolute;
            top: 8px;
            right: 8px;
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 14px;
            padding: 2px;
        }
        
        .notification-close:hover {
            color: #fff;
        }
        
        .empty-notifications {
            text-align: center;
            padding: 30px 0;
            color: #999;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4444;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Settings panel styles */
        .settings-panel {
            position: absolute;
            top: 60px;
            right: 20px;
            width: 300px;
            background: var(--panel-bg, #1a1a1a);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            z-index: 100;
            border: 1px solid var(--border-color, #333);
            overflow: hidden;
            transition: all 0.2s ease;
        }
        
        .settings-panel-header {
            padding: 15px;
            background: var(--panel-header-bg, #222);
            border-bottom: 1px solid var(--border-color, #333);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .settings-panel-content {
            padding: 15px;
        }
        
        .settings-row {
            padding: 10px 0;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .settings-row:last-child {
            border-bottom: none;
        }
        
        /* Toggle switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 46px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #333;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: #fff;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #667eea;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function Dashboard() {
            const [activeTab, setActiveTab] = useState('overview');
            const [metrics, setMetrics] = useState([
                {
                    id: 1,
                    method: 'GET',
                    path: '/api/users',
                    request_count: 1247,
                    avg_response_time: 89,
                    error_rate: 0.02,
                    last_request: new Date(Date.now() - 300000).toISOString(), // 5 minutes ago
                    responseTime: 89,
                    successRate: 98
                },
                {
                    id: 2,
                    method: 'POST',
                    path: '/api/orders',
                    request_count: 892,
                    avg_response_time: 156,
                    error_rate: 0.05,
                    last_request: new Date(Date.now() - 120000).toISOString(), // 2 minutes ago
                    responseTime: 156,
                    successRate: 95
                },
                {
                    id: 3,
                    method: 'GET',
                    path: '/api/products',
                    request_count: 2341,
                    avg_response_time: 67,
                    error_rate: 0.01,
                    last_request: new Date(Date.now() - 60000).toISOString(), // 1 minute ago
                    responseTime: 67,
                    successRate: 99
                },
                {
                    id: 4,
                    method: 'PUT',
                    path: '/api/users/{id}',
                    request_count: 456,
                    avg_response_time: 234,
                    error_rate: 0.08,
                    last_request: new Date(Date.now() - 900000).toISOString(), // 15 minutes ago
                    responseTime: 234,
                    successRate: 92
                },
                {
                    id: 5,
                    method: 'DELETE',
                    path: '/api/orders/{id}',
                    request_count: 123,
                    avg_response_time: 134,
                    error_rate: 0.03,
                    last_request: new Date(Date.now() - 1800000).toISOString(), // 30 minutes ago
                    responseTime: 134,
                    successRate: 97
                }
            ]);
            const [systemMetrics, setSystemMetrics] = useState({
                cpu_usage: 45.2,
                memory_usage: 68.7,
                disk_usage: 23.1,
                network_in: 1024 * 1024 * 15, // 15 MB
                network_out: 1024 * 1024 * 8, // 8 MB
                total_requests: 15847,
                error_count: 23,
                avg_response_time: 156,
                uptime: 86400 * 7, // 7 days in seconds
                active_connections: 234,
                cache_hit_rate: 0.85,
                database_connections: 12,
                memory_total: 8 * 1024 * 1024 * 1024 // 8GB
            });
            const [architecture, setArchitecture] = useState({
                nodes: [
                    {
                        id: 'api-gateway',
                        label: 'API Gateway',
                        node_type: 'endpoint',
                        description: 'Main entry point for all API requests',
                        status: 'active',
                        position: { x: 100, y: 100 },
                        config: {
                            port: 8080,
                            timeout: 30000,
                            rateLimit: '1000/minute'
                        }
                    },
                    {
                        id: 'auth-service',
                        label: 'Auth Service',
                        node_type: 'service',
                        description: 'Authentication and authorization service',
                        status: 'active',
                        position: { x: 300, y: 50 },
                        config: {
                            jwt_expiry: '1h',
                            refresh_token_expiry: '7d'
                        }
                    },
                    {
                        id: 'user-db',
                        label: 'User Database',
                        node_type: 'database',
                        description: 'PostgreSQL database for user data',
                        status: 'active',
                        position: { x: 500, y: 100 },
                        config: {
                            host: 'localhost',
                            port: 5432,
                            pool_size: 20
                        }
                    },
                    {
                        id: 'orders-service',
                        label: 'Orders Service',
                        node_type: 'service',
                        description: 'Order processing and management',
                        status: 'active',
                        position: { x: 300, y: 200 },
                        config: {
                            queue_size: 1000,
                            worker_threads: 4
                        }
                    },
                    {
                        id: 'payment-gateway',
                        label: 'Payment Gateway',
                        node_type: 'external',
                        description: 'External payment processing service',
                        status: 'active',
                        position: { x: 500, y: 250 },
                        config: {
                            timeout: 10000,
                            retry_attempts: 3
                        }
                    }
                ],
                edges: [
                    {
                        id: 'e1',
                        source: 'api-gateway',
                        target: 'auth-service',
                        type: 'api_call'
                    },
                    {
                        id: 'e2',
                        source: 'auth-service',
                        target: 'user-db',
                        type: 'data_flow'
                    },
                    {
                        id: 'e3',
                        source: 'api-gateway',
                        target: 'orders-service',
                        type: 'api_call'
                    },
                    {
                        id: 'e4',
                        source: 'orders-service',
                        target: 'payment-gateway',
                        type: 'external_call'
                    }
                ]
            });
            const [connected, setConnected] = useState(false);
            const [error, setError] = useState(null);
            const [realtimeData, setRealtimeData] = useState([]);
            const [notifications, setNotifications] = useState([]);
            const [showNotifications, setShowNotifications] = useState(false);
            const notificationTimeoutRef = useRef({});
            const wsRef = useRef(null);
            const chartRef = useRef(null);
            const realtimeChartRef = useRef(null);
            
            const addNotification = (notification) => {
                const id = Date.now().toString();
                const newNotification = {
                    ...notification,
                    id,
                    timestamp: new Date()
                };
                
                setNotifications(prev => [newNotification, ...prev].slice(0, 50)); // Keep max 50 notifications
                
                // Auto dismiss after 5 seconds for non-error notifications
                if (notification.type !== 'error') {
                    notificationTimeoutRef.current[id] = setTimeout(() => {
                        removeNotification(id);
                    }, 5000);
                }
                
                return id;
            };
            
            const removeNotification = (id) => {
                if (notificationTimeoutRef.current[id]) {
                    clearTimeout(notificationTimeoutRef.current[id]);
                    delete notificationTimeoutRef.current[id];
                }
                setNotifications(prev => prev.filter(n => n.id !== id));
            };
            
            const toggleNotifications = () => {
                setShowNotifications(!showNotifications);
            };

            useEffect(() => {
                // Try to connect to WebSocket, but fall back to simulation mode if it fails
                connectWebSocket();
                fetchInitialData();
                
                // Welcome notification
                setTimeout(() => {
                    addNotification({
                        type: 'info',
                        title: 'Welcome to Backworks Dashboard',
                        message: 'Dashboard loaded successfully. Running in demo mode with simulated data.'
                    });
                }, 1000);
                
                // Start simulation mode for demo purposes
                const simulationInterval = setInterval(() => {
                    if (settings.autoRefresh) {
                        simulateRealtimeData();
                    }
                }, settings.refreshInterval * 1000);
                
                return () => {
                    if (wsRef.current) {
                        wsRef.current.close();
                    }
                    clearInterval(simulationInterval);
                };
            }, [settings.autoRefresh, settings.refreshInterval]);
            
            // Simulate real-time data for demo purposes
            const simulateRealtimeData = () => {
                const newData = {
                    timestamp: new Date().toISOString(),
                    method: ['GET', 'POST', 'PUT', 'DELETE'][Math.floor(Math.random() * 4)],
                    path: ['/api/users', '/api/orders', '/api/products', '/api/auth'][Math.floor(Math.random() * 4)],
                    status_code: Math.random() > 0.1 ? 200 : (Math.random() > 0.5 ? 400 : 500),
                    response_time: Math.floor(Math.random() * 500) + 50,
                    user_id: Math.floor(Math.random() * 1000)
                };
                
                setRealtimeData(prev => [...prev.slice(-49), newData]); // Keep last 50 items
                
                // Update system metrics periodically
                setSystemMetrics(prev => ({
                    ...prev,
                    cpu_usage: Math.max(10, Math.min(90, prev.cpu_usage + (Math.random() - 0.5) * 5)),
                    memory_usage: Math.max(20, Math.min(95, prev.memory_usage + (Math.random() - 0.5) * 3)),
                    total_requests: prev.total_requests + 1,
                    error_count: newData.status_code >= 400 ? prev.error_count + 1 : prev.error_count
                }));
                
                // Generate notifications for errors
                if (newData.status_code >= 500 && settings.notifications) {
                    addNotification({
                        type: 'error',
                        title: 'Server Error Detected',
                        message: `${newData.method} ${newData.path} returned ${newData.status_code}`
                    });
                } else if (newData.response_time > 400 && settings.notifications) {
                    addNotification({
                        type: 'warning',
                        title: 'Slow Response Time',
                        message: `${newData.method} ${newData.path} took ${newData.response_time}ms`
                    });
                }
            };

            const connectWebSocket = () => {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsUrl = `${protocol}//${window.location.host}/ws`;
                
                try {
                    wsRef.current = new WebSocket(wsUrl);
                    
                    wsRef.current.onopen = () => {
                        setConnected(true);
                        setError(null);
                        console.log('WebSocket connected');
                        addNotification({
                            type: 'success',
                            title: 'Connected',
                            message: 'Real-time connection established'
                        });
                    };
                    
                    wsRef.current.onmessage = (event) => {
                        try {
                            const data = JSON.parse(event.data);
                            handleWebSocketMessage(data);
                        } catch (err) {
                            console.error('Failed to parse WebSocket message:', err);
                        }
                    };
                    
                    wsRef.current.onclose = () => {
                        setConnected(false);
                        console.log('WebSocket disconnected - running in demo mode');
                        // Don't attempt to reconnect for demo purposes
                        // setTimeout(connectWebSocket, 3000);
                    };
                    
                    wsRef.current.onerror = (err) => {
                        setConnected(false);
                        console.log('WebSocket connection failed - running in demo mode');
                        // Don't set error for demo purposes - just run in simulation mode
                    };
                } catch (err) {
                    setConnected(false);
                    console.log('WebSocket creation failed - running in demo mode');
                }
            };

            const fetchInitialData = async () => {
                try {
                    // Try to fetch from real API endpoints, but gracefully handle failures
                    const [metricsRes, systemRes, archRes] = await Promise.all([
                        fetch('/api/metrics').catch(() => ({ ok: false })),
                        fetch('/api/system').catch(() => ({ ok: false })),
                        fetch('/api/architecture').catch(() => ({ ok: false }))
                    ]);
                    
                    if (metricsRes.ok) {
                        setMetrics(await metricsRes.json());
                    }
                    if (systemRes.ok) {
                        setSystemMetrics(await systemRes.json());
                    }
                    if (archRes.ok) {
                        setArchitecture(await archRes.json());
                    }
                } catch (err) {
                    // Gracefully handle API failures - data is already initialized with mock data
                    console.log('API endpoints not available - using mock data for demo');
                }
            };

            const handleWebSocketMessage = (data) => {
                switch (data.event_type || data.type) {
                    case 'initial':
                        setMetrics(data.metrics || []);
                        setSystemMetrics(data.system_metrics || {});
                        setArchitecture(data.architecture || { nodes: [], edges: [] });
                        break;
                    case 'request':
                        updateMetricsFromRequest(data.data);
                        // Add to real-time monitoring data
                        const timestamp = new Date().toISOString();
                        setRealtimeData(prev => {
                            const newData = [...prev, {
                                timestamp,
                                path: data.data.path,
                                method: data.data.method,
                                responseTime: data.data.response_time,
                                statusCode: data.data.status_code
                            }];
                            // Keep only the last 100 entries
                            return newData.slice(-100);
                        });
                        
                        // Check for error status codes and create notifications
                        if (data.data.status_code >= 500) {
                            addNotification({
                                type: 'error',
                                title: 'Server Error',
                                message: `${data.data.method} ${data.data.path} returned ${data.data.status_code}`,
                                timestamp: new Date().toISOString()
                            });
                        } else if (data.data.status_code >= 400) {
                            addNotification({
                                type: 'warning',
                                title: 'Client Error',
                                message: `${data.data.method} ${data.data.path} returned ${data.data.status_code}`,
                                timestamp: new Date().toISOString()
                            });
                        } else if (data.data.response_time > 1000) {
                            addNotification({
                                type: 'warning',
                                title: 'Slow Response',
                                message: `${data.data.method} ${data.data.path} took ${Math.round(data.data.response_time)}ms`,
                                timestamp: new Date().toISOString()
                            });
                        }
                        break;
                    case 'system_metrics':
                        setSystemMetrics(data.data);
                        // Check for system warning conditions
                        if (data.data.cpu_usage > 80) {
                            addNotification({
                                type: 'warning',
                                title: 'High CPU Usage',
                                message: `CPU usage is at ${Math.round(data.data.cpu_usage)}%`,
                                timestamp: new Date().toISOString()
                            });
                        }
                        if (data.data.memory_percent > 85) {
                            addNotification({
                                type: 'warning',
                                title: 'High Memory Usage',
                                message: `Memory usage is at ${Math.round(data.data.memory_percent)}%`,
                                timestamp: new Date().toISOString()
                            });
                        }
                        break;
                    case 'architecture_update':
                        setArchitecture(data.data);
                        break;
                    case 'alert':
                        // Handle explicit alerts from the server
                        if (data.data && data.data.severity) {
                            addNotification({
                                type: data.data.severity,
                                title: data.data.title || 'System Alert',
                                message: data.data.message,
                                timestamp: new Date().toISOString()
                            });
                        }
                        break;
                    default:
                        console.log('Unknown message type:', data.event_type || data.type);
                }
            };

            const updateMetricsFromRequest = (requestData) => {
                setMetrics(prevMetrics => {
                    const key = `${requestData.method} ${requestData.path}`;
                    const existingIndex = prevMetrics.findIndex(m => 
                        m.method === requestData.method && m.path === requestData.path
                    );
                    
                    if (existingIndex >= 0) {
                        const updated = [...prevMetrics];
                        updated[existingIndex] = {
                            ...updated[existingIndex],
                            request_count: updated[existingIndex].request_count + 1,
                            avg_response_time: (updated[existingIndex].avg_response_time + requestData.response_time) / 2,
                            last_request: new Date().toISOString()
                        };
                        return updated;
                    } else {
                        return [...prevMetrics, {
                            path: requestData.path,
                            method: requestData.method,
                            request_count: 1,
                            avg_response_time: requestData.response_time,
                            error_rate: requestData.status_code >= 400 ? 1.0 : 0.0,
                            last_request: new Date().toISOString()
                        }];
                    }
                });
            };

            const formatUptime = (seconds) => {
                const hours = Math.floor(seconds / 3600);
                const minutes = Math.floor((seconds % 3600) / 60);
                return `${hours}h ${minutes}m`;
            };

            const formatBytes = (bytes) => {
                const sizes = ['B', 'KB', 'MB', 'GB'];
                if (bytes === 0) return '0 B';
                const i = Math.floor(Math.log(bytes) / Math.log(1024));
                return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
            };

            const renderOverview = () => {
                const chartContainerRef = useRef(null);
                const [chartInstance, setChartInstance] = useState(null);
                
                useEffect(() => {
                    if (chartContainerRef.current && metrics.length > 0) {
                        // Clean up any existing chart
                        if (chartInstance) {
                            chartInstance.destroy();
                        }
                        
                        // Get metrics for chart
                        const labels = metrics.slice(0, 5).map(m => `${m.method} ${m.path}`);
                        const responseTimeData = metrics.slice(0, 5).map(m => m.avg_response_time);
                        const requestCountData = metrics.slice(0, 5).map(m => m.request_count);
                        
                        // Create new chart
                        const ctx = chartContainerRef.current.getContext('2d');
                        const newChart = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [
                                    {
                                        label: 'Avg Response Time (ms)',
                                        data: responseTimeData,
                                        backgroundColor: 'rgba(102, 126, 234, 0.7)',
                                        borderColor: 'rgba(102, 126, 234, 1)',
                                        borderWidth: 1,
                                        yAxisID: 'y'
                                    },
                                    {
                                        label: 'Request Count',
                                        data: requestCountData,
                                        backgroundColor: 'rgba(118, 75, 162, 0.7)',
                                        borderColor: 'rgba(118, 75, 162, 1)',
                                        borderWidth: 1,
                                        yAxisID: 'y1'
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        type: 'linear',
                                        position: 'left',
                                        title: {
                                            display: true,
                                            text: 'Response Time (ms)',
                                            color: '#888'
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        },
                                        ticks: {
                                            color: '#888'
                                        }
                                    },
                                    y1: {
                                        type: 'linear',
                                        position: 'right',
                                        title: {
                                            display: true,
                                            text: 'Request Count',
                                            color: '#888'
                                        },
                                        grid: {
                                            color: 'transparent'
                                        },
                                        ticks: {
                                            color: '#888'
                                        }
                                    },
                                    x: {
                                        ticks: {
                                            color: '#888',
                                            maxRotation: 45,
                                            minRotation: 45
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        labels: {
                                            color: '#888'
                                        }
                                    }
                                }
                            }
                        });
                        
                        setChartInstance(newChart);
                    }
                    
                    return () => {
                        if (chartInstance) {
                            chartInstance.destroy();
                        }
                    };
                }, [metrics]);
                
                // Get today's date in a nice format
                const today = new Date().toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                return (
                    <div>
                        <div style={{ marginBottom: '20px' }}>
                            <h2 style={{ fontSize: '24px', marginBottom: '10px' }}>Dashboard Overview</h2>
                            <p style={{ color: '#888' }}>
                                System status as of {today}
                            </p>
                        </div>
                        
                        <div className="metrics-grid">
                            <div className="metric-card">
                                <div className="metric-title">Total Requests</div>
                                <div className="metric-value">{systemMetrics.total_requests || 0}</div>
                                {systemMetrics.prev_total_requests && (
                                    <div className={`metric-change ${systemMetrics.total_requests > systemMetrics.prev_total_requests ? 'positive' : 'negative'}`}>
                                        {systemMetrics.total_requests > systemMetrics.prev_total_requests ? '↑' : '↓'} 
                                        {Math.abs(systemMetrics.total_requests - systemMetrics.prev_total_requests)} from previous
                                    </div>
                                )}
                            </div>
                            <div className="metric-card">
                                <div className="metric-title">Active Endpoints</div>
                                <div className="metric-value">{metrics.length}</div>
                            </div>
                            <div className="metric-card">
                                <div className="metric-title">Error Rate</div>
                                <div className="metric-value">
                                    {systemMetrics.total_requests > 0 
                                        ? Math.round((systemMetrics.error_count / systemMetrics.total_requests) * 100 * 100) / 100
                                        : 0}%
                                </div>
                            </div>
                            <div className="metric-card">
                                <div className="metric-title">Uptime</div>
                                <div className="metric-value">{formatUptime(systemMetrics.uptime || 0)}</div>
                            </div>
                            <div className="metric-card">
                                <div className="metric-title">Memory Usage</div>
                                <div className="metric-value">{formatBytes(systemMetrics.memory_usage || 0)}</div>
                                <div className="metric-progress" style={{ height: '4px', background: '#333', marginTop: '10px', borderRadius: '2px' }}>
                                    <div style={{
                                        height: '100%',
                                        width: `${systemMetrics.memory_percent || 0}%`,
                                        background: `${(systemMetrics.memory_percent || 0) > 80 ? '#ff4444' : '#667eea'}`,
                                        borderRadius: '2px'
                                    }}></div>
                                </div>
                            </div>
                            <div className="metric-card">
                                <div className="metric-title">CPU Usage</div>
                                <div className="metric-value">{(systemMetrics.cpu_usage || 0).toFixed(1)}%</div>
                                <div className="metric-progress" style={{ height: '4px', background: '#333', marginTop: '10px', borderRadius: '2px' }}>
                                    <div style={{
                                        height: '100%',
                                        width: `${systemMetrics.cpu_usage || 0}%`,
                                        background: `${(systemMetrics.cpu_usage || 0) > 80 ? '#ff4444' : '#00aa44'}`,
                                        borderRadius: '2px'
                                    }}></div>
                                </div>
                            </div>
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginBottom: '20px' }}>
                            <div className="chart-container">
                                <div className="chart-title">Top 5 Endpoints Performance</div>
                                <div style={{ height: '300px', position: 'relative' }}>
                                    {metrics.length === 0 ? (
                                        <div className="loading">No endpoint data available</div>
                                    ) : (
                                        <canvas ref={chartContainerRef}></canvas>
                                    )}
                                </div>
                            </div>
                            
                            <div className="chart-container">
                                <div className="chart-title">System Status</div>
                                <div style={{ 
                                    padding: '20px',
                                    height: '300px',
                                    display: 'flex',
                                    flexDirection: 'column',
                                    justifyContent: 'space-between'
                                }}>
                                    <div>
                                        <div style={{ 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            marginBottom: '15px',
                                            padding: '15px',
                                            background: '#222',
                                            borderRadius: '8px'
                                        }}>
                                            <div style={{ 
                                                width: '12px', 
                                                height: '12px', 
                                                borderRadius: '50%',
                                                backgroundColor: '#00aa44',
                                                marginRight: '10px'
                                            }}></div>
                                            <div>
                                                <div style={{ fontWeight: 'bold' }}>API Server</div>
                                                <div style={{ fontSize: '13px', color: '#888' }}>Online - Processing requests</div>
                                            </div>
                                            <div style={{ marginLeft: 'auto', color: '#aaa', fontSize: '12px' }}>
                                                {formatUptime(systemMetrics.uptime || 0)}
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            display: 'flex', 
                                            alignItems: 'center',
                                            marginBottom: '15px',
                                            padding: '15px',
                                            background: '#222',
                                            borderRadius: '8px'
                                        }}>
                                            <div style={{ 
                                                width: '12px', 
                                                height: '12px', 
                                                borderRadius: '50%',
                                                backgroundColor: '#00aa44',
                                                marginRight: '10px'
                                            }}></div>
                                            <div>
                                                <div style={{ fontWeight: 'bold' }}>Dashboard</div>
                                                <div style={{ fontSize: '13px', color: '#888' }}>Connected - Real-time metrics</div>
                                            </div>
                                            <div style={{ marginLeft: 'auto', color: '#aaa', fontSize: '12px' }}>
                                                Active
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            display: 'flex', 
                                            alignItems: 'center',
                                            padding: '15px',
                                            background: '#222',
                                            borderRadius: '8px'
                                        }}>
                                            <div style={{ 
                                                width: '12px', 
                                                height: '12px', 
                                                borderRadius: '50%',
                                                backgroundColor: systemMetrics.ai_enabled ? '#00aa44' : '#888',
                                                marginRight: '10px'
                                            }}></div>
                                            <div>
                                                <div style={{ fontWeight: 'bold' }}>AI Module</div>
                                                <div style={{ fontSize: '13px', color: '#888' }}>
                                                    {systemMetrics.ai_enabled ? 'Active - Analyzing traffic' : 'Disabled'}
                                                </div>
                                            </div>
                                            <div style={{ marginLeft: 'auto', color: '#aaa', fontSize: '12px' }}>
                                                {systemMetrics.ai_enabled ? 'Enabled' : 'Disabled'}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style={{ marginTop: '15px', alignSelf: 'flex-end' }}>
                                        <button style={{
                                            background: 'none',
                                            border: '1px solid #667eea',
                                            color: '#667eea',
                                            padding: '8px 15px',
                                            borderRadius: '4px',
                                            cursor: 'pointer'
                                        }}>
                                            View System Logs
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="chart-container">
                            <div className="chart-title">Recent Endpoint Activity</div>
                            <div className="endpoint-list">
                                {metrics.length === 0 ? (
                                    <div className="loading">No endpoints active</div>
                                ) : (
                                    metrics.map((metric, index) => (
                                        <div key={index} className="endpoint-item">
                                            <div style={{ display: 'flex', alignItems: 'center' }}>
                                                <span className={`endpoint-method method-${metric.method.toLowerCase()}`}>
                                                    {metric.method}
                                                </span>
                                                <span className="endpoint-path">{metric.path}</span>
                                            </div>
                                            <div className="endpoint-stats">
                                                <span>{metric.request_count} requests</span>
                                                <span>{Math.round(metric.avg_response_time)}ms avg</span>
                                                <span>{Math.round(metric.error_rate * 100)}% errors</span>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            const renderEndpoints = () => {
                const [selectedEndpoint, setSelectedEndpoint] = useState(null);
                const [endpointFilter, setEndpointFilter] = useState('');
                const [activeTab, setActiveTab] = useState('overview');
                const [mockEnabled, setMockEnabled] = useState(false);
                const [rateLimit, setRateLimit] = useState(100);
                const [cacheTtl, setCacheTtl] = useState(60);
                const endpointChartRef = useRef(null);
                const [endpointChartInstance, setEndpointChartInstance] = useState(null);
                
                // Mocking some response time history data
                const generateMockTimeData = () => {
                    const now = new Date();
                    return [...Array(24).keys()].map(i => {
                        const time = new Date(now);
                        time.setHours(now.getHours() - (24 - i));
                        return {
                            time: time.toISOString(),
                            responseTime: Math.floor(Math.random() * 200) + 50,
                            success: Math.random() > 0.1
                        };
                    });
                };
                
                const [responseHistory] = useState(generateMockTimeData());
                
                useEffect(() => {
                    if (selectedEndpoint && activeTab === 'performance' && endpointChartRef.current) {
                        if (endpointChartInstance) {
                            endpointChartInstance.destroy();
                        }
                        
                        const ctx = endpointChartRef.current.getContext('2d');
                        const timeLabels = responseHistory.map(d => {
                            const date = new Date(d.time);
                            return `${date.getHours()}:${date.getMinutes().toString().padStart(2, '0')}`;
                        });
                        
                        const responseData = responseHistory.map(d => d.responseTime);
                        const successData = responseHistory.map(d => d.success ? 1 : 0);
                        
                        const newChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: timeLabels,
                                datasets: [
                                    {
                                        label: 'Response Time (ms)',
                                        data: responseData,
                                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                                        borderColor: 'rgba(102, 126, 234, 1)',
                                        borderWidth: 2,
                                        tension: 0.2,
                                        pointRadius: 3,
                                        yAxisID: 'y'
                                    },
                                    {
                                        label: 'Success Status',
                                        data: successData,
                                        backgroundColor: 'rgba(0, 200, 83, 0.2)',
                                        borderColor: 'rgba(0, 200, 83, 1)',
                                        borderWidth: 2,
                                        yAxisID: 'y1',
                                        stepped: true
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                scales: {
                                    y: {
                                        type: 'linear',
                                        position: 'left',
                                        title: {
                                            display: true,
                                            text: 'Response Time (ms)',
                                            color: '#888'
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        },
                                        ticks: {
                                            color: '#888'
                                        }
                                    },
                                    y1: {
                                        type: 'linear',
                                        position: 'right',
                                        title: {
                                            display: true,
                                            text: 'Success Status',
                                            color: '#888'
                                        },
                                        min: 0,
                                        max: 1,
                                        grid: {
                                            color: 'transparent'
                                        },
                                        ticks: {
                                            color: '#888',
                                            stepSize: 1,
                                            callback: value => value === 1 ? 'Success' : 'Error'
                                        }
                                    },
                                    x: {
                                        ticks: {
                                            color: '#888'
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        labels: {
                                            color: '#888'
                                        }
                                    },
                                    tooltip: {
                                        callbacks: {
                                            label: function(context) {
                                                if (context.datasetIndex === 1) {
                                                    return context.raw === 1 ? 'Success' : 'Error';
                                                }
                                                return `Response time: ${context.raw} ms`;
                                            }
                                        }
                                    }
                                }
                            }
                        });
                        
                        setEndpointChartInstance(newChart);
                    }
                    
                    return () => {
                        if (endpointChartInstance) {
                            endpointChartInstance.destroy();
                        }
                    };
                }, [selectedEndpoint, activeTab]);
                
                const filteredEndpoints = metrics.filter(endpoint => 
                    endpoint.path.toLowerCase().includes(endpointFilter.toLowerCase()) || 
                    endpoint.method.toLowerCase().includes(endpointFilter.toLowerCase())
                );
                
                const handleEndpointClick = (endpoint) => {
                    setSelectedEndpoint(endpoint);
                    setActiveTab('overview');
                    setRateLimit(100);
                    setCacheTtl(60);
                };
                
                const handleSaveConfig = () => {
                    // This would normally save to the backend
                    addNotification({
                        type: 'success',
                        title: 'Configuration Saved',
                        message: `Configuration for ${selectedEndpoint.method} ${selectedEndpoint.path} has been saved.`
                    });
                };
                
                const handleToggleMock = () => {
                    setMockEnabled(!mockEnabled);
                    // In a real implementation, this would tell the backend to start/stop mocking
                    addNotification({
                        type: 'info',
                        title: 'Mock Mode Updated',
                        message: `Mock responses for ${selectedEndpoint.method} ${selectedEndpoint.path} are now ${!mockEnabled ? 'enabled' : 'disabled'}.`
                    });
                };
                
                const exportEndpointData = (format) => {
                    // In a real application, this would fetch from the backend API
                    if (!selectedEndpoint) return;
                    
                    const endpoint = selectedEndpoint;
                    let data;
                    
                    switch (format) {
                        case 'json':
                            data = JSON.stringify({
                                endpoint: {
                                    method: endpoint.method,
                                    path: endpoint.path,
                                    responseTime: endpoint.responseTime,
                                    successRate: endpoint.successRate,
                                    requestCount: endpoint.requestCount,
                                    lastAccessed: endpoint.lastAccessed
                                },
                                configuration: {
                                    mockEnabled,
                                    rateLimit,
                                    cacheTtl
                                },
                                history: responseHistory
                            }, null, 2);
                            downloadData(data, `endpoint-${endpoint.method}-${endpoint.path.replace(/\//g, '-')}.json`, 'application/json');
                            break;
                            
                        case 'csv':
                            // Header
                            data = 'Time,Response Time (ms),Success\n';
                            // Data rows
                            responseHistory.forEach(point => {
                                data += `${point.time},${point.responseTime},${point.success ? 1 : 0}\n`;
                            });
                            downloadData(data, `endpoint-${endpoint.method}-${endpoint.path.replace(/\//g, '-')}.csv`, 'text/csv');
                            break;
                            
                        case 'har':
                            // Simple HAR format
                            const har = {
                                log: {
                                    version: '1.2',
                                    creator: {
                                        name: 'Backworks Dashboard',
                                        version: '1.0'
                                    },
                                    entries: responseHistory.map((point, idx) => ({
                                        startedDateTime: point.time,
                                        request: {
                                            method: endpoint.method,
                                            url: `http://example.com${endpoint.path}`,
                                            httpVersion: 'HTTP/1.1',
                                            cookies: [],
                                            headers: [],
                                            queryString: [],
                                            headersSize: -1,
                                            bodySize: -1
                                        },
                                        response: {
                                            status: point.success ? 200 : 500,
                                            statusText: point.success ? 'OK' : 'Error',
                                            httpVersion: 'HTTP/1.1',
                                            cookies: [],
                                            headers: [],
                                            content: {
                                                size: 0,
                                                mimeType: 'application/json'
                                            },
                                            redirectURL: '',
                                            headersSize: -1,
                                            bodySize: -1
                                        },
                                        time: point.responseTime,
                                        cache: {},
                                        timings: {
                                            send: 0,
                                            wait: point.responseTime,
                                            receive: 0
                                        }
                                    }))
                                }
                            };
                            downloadData(JSON.stringify(har, null, 2), `endpoint-${endpoint.method}-${endpoint.path.replace(/\//g, '-')}.har`, 'application/json');
                            break;
                    }
                    
                    addNotification({
                        type: 'success',
                        title: 'Export Complete',
                        message: `Data for ${endpoint.method} ${endpoint.path} has been exported as ${format.toUpperCase()}.`
                    });
                };
                
                const downloadData = (data, filename, type) => {
                    const blob = new Blob([data], { type });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                };
                
                const renderTabContent = () => {
                    switch (activeTab) {
                        case 'overview':
                            return (
                                <>
                                    <div style={{ 
                                        display: 'grid', 
                                        gridTemplateColumns: 'repeat(3, 1fr)', 
                                        gap: '20px',
                                        marginBottom: '20px'
                                    }}>
                                        <div className="metric-card" style={{ margin: 0 }}>
                                            <div className="metric-title">Requests</div>
                                            <div className="metric-value">{selectedEndpoint.request_count}</div>
                                        </div>
                                        <div className="metric-card" style={{ margin: 0 }}>
                                            <div className="metric-title">Avg Response Time</div>
                                            <div className="metric-value">{Math.round(selectedEndpoint.avg_response_time)} ms</div>
                                        </div>
                                        <div className="metric-card" style={{ margin: 0 }}>
                                            <div className="metric-title">Error Rate</div>
                                            <div className="metric-value">{Math.round(selectedEndpoint.error_rate * 100)}%</div>
                                        </div>
                                    </div>
                                    
                                    <div style={{ marginTop: '20px' }}>
                                        <h3 style={{ marginBottom: '10px', color: '#bbb' }}>Quick Actions</h3>
                                        <div style={{ display: 'flex', gap: '10px', marginTop: '10px' }}>
                                            <button 
                                                style={{
                                                    padding: '8px 16px',
                                                    borderRadius: '6px',
                                                    background: mockEnabled ? '#cc0000' : '#444',
                                                    border: 'none',
                                                    color: '#fff',
                                                    cursor: 'pointer'
                                                }}
                                                onClick={handleToggleMock}
                                            >
                                                {mockEnabled ? 'Disable Mock' : 'Enable Mock'}
                                            </button>
                                            
                                            <button 
                                                style={{
                                                    padding: '8px 16px',
                                                    borderRadius: '6px',
                                                    background: '#007bff',
                                                    border: 'none',
                                                    color: '#fff',
                                                    cursor: 'pointer',
                                                    marginRight: '10px'
                                                }}
                                                onClick={() => window.open(`/test/${selectedEndpoint.path}`, '_blank')}
                                            >
                                                Test Endpoint
                                            </button>
                                            
                                            <div className="dropdown" style={{ display: 'inline-block', position: 'relative' }}>
                                                <button 
                                                    style={{
                                                        padding: '8px 16px',
                                                        borderRadius: '6px',
                                                        background: '#3c875c',
                                                        border: 'none',
                                                        color: '#fff',
                                                        cursor: 'pointer',
                                                        display: 'flex',
                                                        alignItems: 'center'
                                                    }}
                                                    onClick={(e) => {
                                                        const dropdown = e.currentTarget.nextElementSibling;
                                                        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                                                    }}
                                                >
                                                    Export Data ▼
                                                </button>
                                                <div style={{ 
                                                    display: 'none', 
                                                    position: 'absolute', 
                                                    backgroundColor: '#222', 
                                                    minWidth: '160px', 
                                                    boxShadow: '0px 8px 16px 0px rgba(0,0,0,0.5)',
                                                    zIndex: 1,
                                                    borderRadius: '4px',
                                                    border: '1px solid #333',
                                                    top: '100%',
                                                    right: 0
                                                }}>
                                                    <a onClick={() => exportEndpointData('json')} style={{ 
                                                        color: '#ddd', 
                                                        padding: '12px 16px', 
                                                        textDecoration: 'none', 
                                                        display: 'block', 
                                                        cursor: 'pointer',
                                                        borderBottom: '1px solid #333'
                                                    }}>
                                                        Export as JSON
                                                    </a>
                                                    <a onClick={() => exportEndpointData('csv')} style={{ 
                                                        color: '#ddd', 
                                                        padding: '12px 16px', 
                                                        textDecoration: 'none', 
                                                        display: 'block',
                                                        cursor: 'pointer',
                                                        borderBottom: '1px solid #333'
                                                    }}>
                                                        Export as CSV
                                                    </a>
                                                    <a onClick={() => exportEndpointData('har')} style={{ 
                                                        color: '#ddd', 
                                                        padding: '12px 16px', 
                                                        textDecoration: 'none', 
                                                        display: 'block',
                                                        cursor: 'pointer'
                                                    }}>
                                                        Export as HAR
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style={{ marginTop: '20px' }}>
                                        <h3 style={{ marginBottom: '10px', color: '#bbb' }}>Endpoint Information</h3>
                                        <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                                            <tbody>
                                                <tr style={{ borderBottom: '1px solid #333' }}>
                                                    <td style={{ padding: '8px 0', color: '#888' }}>Path</td>
                                                    <td style={{ padding: '8px 0', fontFamily: 'monospace' }}>{selectedEndpoint.path}</td>
                                                </tr>
                                                <tr style={{ borderBottom: '1px solid #333' }}>
                                                    <td style={{ padding: '8px 0', color: '#888' }}>Method</td>
                                                    <td style={{ padding: '8px 0' }}>
                                                        <span className={`endpoint-method method-${selectedEndpoint.method.toLowerCase()}`}>
                                                            {selectedEndpoint.method}
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr style={{ borderBottom: '1px solid #333' }}>
                                                    <td style={{ padding: '8px 0', color: '#888' }}>Last Request</td>
                                                    <td style={{ padding: '8px 0' }}>{new Date(selectedEndpoint.last_request).toLocaleString()}</td>
                                                </tr>
                                                <tr style={{ borderBottom: '1px solid #333' }}>
                                                    <td style={{ padding: '8px 0', color: '#888' }}>Status</td>
                                                    <td style={{ padding: '8px 0' }}>
                                                        <span style={{ 
                                                            display: 'inline-block', 
                                                            width: '10px', 
                                                            height: '10px', 
                                                            borderRadius: '50%', 
                                                            background: selectedEndpoint.error_rate < 0.05 ? '#00cc44' : '#cc0000',
                                                            marginRight: '8px'
                                                        }}></span>
                                                        {selectedEndpoint.error_rate < 0.05 ? 'Healthy' : 'Issues Detected'}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </>
                            );
                        
                        case 'performance':
                            return (
                                <>
                                    <div style={{ height: '300px', marginBottom: '20px' }}>
                                        <canvas ref={endpointChartRef}></canvas>
                                    </div>
                                    
                                    <div style={{ marginTop: '20px' }}>
                                        <h3 style={{ marginBottom: '10px', color: '#bbb' }}>Performance Metrics</h3>
                                        <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                                            <thead>
                                                <tr style={{ borderBottom: '1px solid #333' }}>
                                                    <th style={{ padding: '8px 0', textAlign: 'left', color: '#888' }}>Time</th>
                                                    <th style={{ padding: '8px 0', textAlign: 'left', color: '#888' }}>Status</th>
                                                    <th style={{ padding: '8px 0', textAlign: 'left', color: '#888' }}>Response Time</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {responseHistory.slice(-5).reverse().map((entry, i) => (
                                                    <tr key={i} style={{ borderBottom: '1px solid #333' }}>
                                                        <td style={{ padding: '8px 0' }}>{new Date(entry.time).toLocaleTimeString()}</td>
                                                        <td style={{ padding: '8px 0' }}>
                                                            <span style={{ 
                                                                color: entry.success ? '#00cc44' : '#cc0000',
                                                                fontWeight: 'bold'
                                                            }}>
                                                                {entry.success ? 'SUCCESS' : 'ERROR'}
                                                            </span>
                                                        </td>
                                                        <td style={{ padding: '8px 0' }}>{entry.responseTime} ms</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </>
                            );
                        
                        case 'config':
                            return (
                                <>
                                    <div style={{ marginBottom: '20px' }}>
                                        <h3 style={{ marginBottom: '15px', color: '#bbb' }}>Endpoint Configuration</h3>
                                        
                                        <div style={{ marginBottom: '15px' }}>
                                            <label style={{ display: 'block', marginBottom: '5px', color: '#888' }}>
                                                Rate Limit (requests per minute)
                                            </label>
                                            <input
                                                type="number"
                                                min="1"
                                                max="1000"
                                                value={rateLimit}
                                                onChange={(e) => setRateLimit(parseInt(e.target.value))}
                                                style={{
                                                    background: '#2a2a2a',
                                                    border: '1px solid #444',
                                                    padding: '8px 12px',
                                                    borderRadius: '6px',
                                                    color: '#fff',
                                                    width: '100%'
                                                }}
                                            />
                                        </div>
                                        
                                        <div style={{ marginBottom: '15px' }}>
                                            <label style={{ display: 'block', marginBottom: '5px', color: '#888' }}>
                                                Cache TTL (seconds)
                                            </label>
                                            <input
                                                type="number"
                                                min="0"
                                                max="3600"
                                                value={cacheTtl}
                                                onChange={(e) => setCacheTtl(parseInt(e.target.value))}
                                                style={{
                                                    background: '#2a2a2a',
                                                    border: '1px solid #444',
                                                    padding: '8px 12px',
                                                    borderRadius: '6px',
                                                    color: '#fff',
                                                    width: '100%'
                                                }}
                                            />
                                        </div>
                                        
                                        <div style={{ marginTop: '10px' }}>
                                            <label style={{ display: 'flex', alignItems: 'center', color: '#888', cursor: 'pointer', marginBottom: '15px' }}>
                                                <input
                                                    type="checkbox"
                                                    checked={mockEnabled}
                                                    onChange={handleToggleMock}
                                                    style={{ marginRight: '10px' }}
                                                />
                                                Enable Mock Response
                                            </label>
                                        </div>
                                        
                                        {mockEnabled && (
                                            <div style={{ marginBottom: '15px' }}>
                                                <label style={{ display: 'block', marginBottom: '5px', color: '#888' }}>
                                                    Mock Response JSON
                                                </label>
                                                <textarea
                                                    defaultValue={`{\n  "status": "success",\n  "data": {\n    "id": 12345,\n    "name": "Example",\n    "timestamp": "${new Date().toISOString()}"\n  }\n}`}
                                                    rows="8"
                                                    style={{
                                                        background: '#2a2a2a',
                                                        border: '1px solid #444',
                                                        padding: '8px 12px',
                                                        borderRadius: '6px',
                                                        color: '#fff',
                                                        width: '100%',
                                                        fontFamily: 'monospace'
                                                    }}
                                                ></textarea>
                                            </div>
                                        )}
                                        
                                        <button
                                            onClick={handleSaveConfig}
                                            style={{
                                                padding: '8px 16px',
                                                borderRadius: '6px',
                                                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                                border: 'none',
                                                color: '#fff',
                                                cursor: 'pointer',
                                                marginTop: '15px'
                                            }}
                                        >
                                            Save Configuration
                                        </button>
                                    </div>
                                </>
                            );
                            
                        default:
                            return <div>Tab content not available</div>;
                    }
                };
                
                return (
                    <div>
                        <div className="endpoints-header">
                            <div className="chart-title">API Endpoints</div>
                            <div className="endpoint-filter">
                                <input 
                                    type="text" 
                                    placeholder="Filter endpoints..." 
                                    value={endpointFilter}
                                    onChange={(e) => setEndpointFilter(e.target.value)}
                                    style={{
                                        background: '#2a2a2a',
                                        border: '1px solid #444',
                                        padding: '8px 12px',
                                        borderRadius: '6px',
                                        color: '#fff',
                                        width: '250px',
                                    }}
                                />
                            </div>
                        </div>
                        
                        <div className="endpoints-container" style={{ display: 'grid', gridTemplateColumns: selectedEndpoint ? '1fr 2fr' : '1fr', gap: '20px' }}>
                            <div className="endpoint-list-container">
                                <div className="endpoint-list" style={{ maxHeight: '750px', overflowY: 'auto' }}>
                                    {filteredEndpoints.length === 0 ? (
                                        <div className="loading">No endpoints matching filter</div>
                                    ) : (
                                        filteredEndpoints.map((endpoint, index) => (
                                            <div 
                                                key={index} 
                                                className={`endpoint-item ${selectedEndpoint && selectedEndpoint.path === endpoint.path && selectedEndpoint.method === endpoint.method ? 'selected' : ''}`}
                                                onClick={() => handleEndpointClick(endpoint)}
                                            >
                                                <div style={{ display: 'flex', alignItems: 'center' }}>
                                                    <span className={`endpoint-method method-${endpoint.method.toLowerCase()}`}>
                                                        {endpoint.method}
                                                    </span>
                                                    <span className="endpoint-path">{endpoint.path}</span>
                                                </div>
                                                <div className="endpoint-stats">
                                                    <span>{endpoint.request_count} req</span>
                                                    <span>{Math.round(endpoint.avg_response_time)}ms</span>
                                                    <span style={{ color: endpoint.error_rate > 0.05 ? '#ff4444' : '#888' }}>
                                                        {Math.round(endpoint.error_rate * 100)}% error
                                                    </span>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                            
                            {selectedEndpoint && (
                                <div className="endpoint-details" style={{ 
                                    background: '#1a1a1a', 
                                    borderRadius: '12px', 
                                    border: '1px solid #333',
                                    padding: '20px'
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                                        <div>
                                            <h2 style={{ marginBottom: '10px' }}>
                                                <span className={`endpoint-method method-${selectedEndpoint.method.toLowerCase()}`} style={{ marginRight: '10px' }}>
                                                    {selectedEndpoint.method}
                                                </span>
                                                <span style={{ fontSize: '1.2em', fontFamily: 'monospace' }}>
                                                    {selectedEndpoint.path}
                                                </span>
                                            </h2>
                                            <div style={{ fontSize: '0.9em', color: '#888' }}>
                                                Last request: {new Date(selectedEndpoint.last_request).toLocaleTimeString()}
                                            </div>
                                        </div>
                                        <button 
                                            onClick={() => setSelectedEndpoint(null)}
                                            style={{
                                                background: 'none',
                                                border: 'none',
                                                color: '#888',
                                                fontSize: '1.5em',
                                                cursor: 'pointer'
                                            }}
                                        >×</button>
                                    </div>
                                    
                                    <div style={{ display: 'flex', borderBottom: '1px solid #333', marginBottom: '20px' }}>
                                        <div 
                                            className={activeTab === 'overview' ? 'active' : ''}
                                            onClick={() => setActiveTab('overview')}
                                            style={{ 
                                                padding: '10px 20px', 
                                                cursor: 'pointer',
                                                borderBottom: activeTab === 'overview' ? '2px solid #667eea' : 'none',
                                                color: activeTab === 'overview' ? '#fff' : '#888'
                                            }}
                                        >
                                            Overview
                                        </div>
                                        <div 
                                            className={activeTab === 'performance' ? 'active' : ''}
                                            onClick={() => setActiveTab('performance')}
                                            style={{ 
                                                padding: '10px 20px', 
                                                cursor: 'pointer',
                                                borderBottom: activeTab === 'performance' ? '2px solid #667eea' : 'none',
                                                color: activeTab === 'performance' ? '#fff' : '#888'
                                            }}
                                        >
                                            Performance
                                        </div>
                                        <div 
                                            className={activeTab === 'config' ? 'active' : ''}
                                            onClick={() => setActiveTab('config')}
                                            style={{ 
                                                padding: '10px 20px', 
                                                cursor: 'pointer',
                                                borderBottom: activeTab === 'config' ? '2px solid #667eea' : 'none',
                                                color: activeTab === 'config' ? '#fff' : '#888'
                                            }}
                                        >
                                            Configuration
                                        </div>
                                    </div>
                                    
                                    {renderTabContent()}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            const renderMonitoring = () => {
                const [activeMetric, setActiveMetric] = useState('response_time');
                const realtimeChartInstanceRef = useRef(null);
                const maxDataPoints = 50;
                
                useEffect(() => {
                    if (realtimeChartRef.current) {
                        if (realtimeChartInstanceRef.current) {
                            realtimeChartInstanceRef.current.destroy();
                        }
                        
                        const ctx = realtimeChartRef.current.getContext('2d');
                        
                        // Calculate data based on active metric
                        let chartData = [];
                        let chartLabels = [];
                        
                        if (realtimeData.length > 0) {
                            // Get last N data points
                            const displayData = realtimeData.slice(-maxDataPoints);
                            
                            // Group by method for better visualization
                            const methodGroups = {};
                            
                            displayData.forEach(entry => {
                                const method = entry.method;
                                if (!methodGroups[method]) {
                                    methodGroups[method] = [];
                                }
                                methodGroups[method].push(entry);
                                
                                if (!chartLabels.includes(new Date(entry.timestamp).toLocaleTimeString())) {
                                    chartLabels.push(new Date(entry.timestamp).toLocaleTimeString());
                                }
                            });
                            
                            // Create dataset for each HTTP method
                            const datasets = [];
                            const methodColors = {
                                'GET': 'rgba(0, 170, 68, 0.7)',
                                'POST': 'rgba(0, 102, 204, 0.7)',
                                'PUT': 'rgba(255, 136, 0, 0.7)',
                                'DELETE': 'rgba(204, 0, 0, 0.7)',
                                'PATCH': 'rgba(156, 39, 176, 0.7)',
                                'OPTIONS': 'rgba(121, 85, 72, 0.7)',
                                'HEAD': 'rgba(96, 125, 139, 0.7)',
                            };
                            
                            Object.keys(methodGroups).forEach(method => {
                                const data = Array(chartLabels.length).fill(null);
                                
                                methodGroups[method].forEach(entry => {
                                    const idx = chartLabels.indexOf(new Date(entry.timestamp).toLocaleTimeString());
                                    if (idx !== -1) {
                                        let value;
                                        
                                        switch (activeMetric) {
                                            case 'response_time':
                                                value = entry.responseTime;
                                                break;
                                            case 'status_code':
                                                value = entry.statusCode;
                                                break;
                                            default:
                                                value = entry.responseTime;
                                        }
                                        
                                        data[idx] = value;
                                    }
                                });
                                
                                datasets.push({
                                    label: method,
                                    data: data,
                                    backgroundColor: methodColors[method] || 'rgba(128, 128, 128, 0.7)',
                                    borderColor: methodColors[method]?.replace('0.7', '1') || 'rgba(128, 128, 128, 1)',
                                    borderWidth: 2,
                                    pointRadius: 3,
                                    pointHoverRadius: 5,
                                    tension: 0.2,
                                    fill: false
                                });
                            });
                            
                            chartData = datasets;
                        }
                        
                        const newChart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: chartLabels,
                                datasets: chartData
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                animation: {
                                    duration: 0 // Disable animation for better performance on real-time data
                                },
                                scales: {
                                    y: {
                                        title: {
                                            display: true,
                                            text: activeMetric === 'response_time' ? 'Response Time (ms)' : 'Status Code',
                                            color: '#888'
                                        },
                                        ticks: {
                                            color: '#888'
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        }
                                    },
                                    x: {
                                        ticks: {
                                            color: '#888',
                                            maxRotation: 45,
                                            minRotation: 45,
                                            maxTicksLimit: 10
                                        },
                                        grid: {
                                            color: 'rgba(255, 255, 255, 0.1)'
                                        }
                                    }
                                },
                                plugins: {
                                    legend: {
                                        position: 'top',
                                        labels: {
                                            color: '#888'
                                        }
                                    },
                                    tooltip: {
                                        mode: 'index',
                                        intersect: false
                                    }
                                }
                            }
                        });
                        
                        realtimeChartInstanceRef.current = newChart;
                    }
                    
                    return () => {
                        if (realtimeChartInstanceRef.current) {
                            realtimeChartInstanceRef.current.destroy();
                        }
                    };
                }, [realtimeData, activeMetric]);
                
                return (
                    <div>
                        <div style={{ marginBottom: '20px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                            <h2 style={{ fontSize: '24px', margin: 0 }}>Real-time Monitor</h2>
                            <div className="metric-selector" style={{ display: 'flex', gap: '10px' }}>
                                <button
                                    onClick={() => setActiveMetric('response_time')}
                                    style={{
                                        padding: '8px 16px',
                                        borderRadius: '6px',
                                        background: activeMetric === 'response_time' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#2a2a2a',
                                        border: 'none',
                                        color: '#fff',
                                        cursor: 'pointer'
                                    }}
                                >
                                    Response Time
                                </button>
                                <button
                                    onClick={() => setActiveMetric('status_code')}
                                    style={{
                                        padding: '8px 16px',
                                        borderRadius: '6px',
                                        background: activeMetric === 'status_code' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#2a2a2a',
                                        border: 'none',
                                        color: '#fff',
                                        cursor: 'pointer'
                                    }}
                                >
                                    Status Codes
                                </button>
                            </div>
                        </div>
                        
                        <div className="chart-container">
                            <div style={{ height: '400px', position: 'relative' }}>
                                {realtimeData.length === 0 ? (
                                    <div className="loading">Waiting for incoming requests...</div>
                                ) : (
                                    <canvas ref={realtimeChartRef}></canvas>
                                )}
                            </div>
                        </div>
                        
                        <div className="chart-container">
                            <div className="chart-title">Recent Requests</div>
                            <div style={{ maxHeight: '300px', overflowY: 'auto' }}>
                                <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                                    <thead>
                                        <tr style={{ borderBottom: '2px solid #333' }}>
                                            <th style={{ padding: '10px', textAlign: 'left', color: '#888' }}>Time</th>
                                            <th style={{ padding: '10px', textAlign: 'left', color: '#888' }}>Method</th>
                                            <th style={{ padding: '10px', textAlign: 'left', color: '#888' }}>Path</th>
                                            <th style={{ padding: '10px', textAlign: 'left', color: '#888' }}>Status</th>
                                            <th style={{ padding: '10px', textAlign: 'left', color: '#888' }}>Response Time</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {realtimeData.slice(-10).reverse().map((entry, index) => (
                                            <tr key={index} style={{ borderBottom: '1px solid #333' }}>
                                                <td style={{ padding: '10px' }}>{new Date(entry.timestamp).toLocaleTimeString()}</td>
                                                <td style={{ padding: '10px' }}>
                                                    <span className={`endpoint-method method-${entry.method.toLowerCase()}`}>
                                                        {entry.method}
                                                    </span>
                                                </td>
                                                <td style={{ padding: '10px', fontFamily: 'monospace' }}>{entry.path}</td>
                                                <td style={{ padding: '10px' }}>
                                                    <span style={{
                                                        color: entry.statusCode < 400 ? '#00cc44' : '#cc0000',
                                                        fontWeight: 'bold'
                                                    }}>
                                                        {entry.statusCode}
                                                    </span>
                                                </td>
                                                <td style={{ padding: '10px' }}>{entry.responseTime} ms</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };
            
            const renderAIInsights = () => {
                const [selectedInsight, setSelectedInsight] = useState(null);
                const [loading, setLoading] = useState(false);
                
                // Mock insights data
                const insights = [
                    {
                        id: 1,
                        title: "API Usage Patterns",
                        description: "Analysis of endpoint usage patterns and potential optimizations.",
                        severity: "info",
                        created: new Date(Date.now() - 3600000).toISOString()
                    },
                    {
                        id: 2,
                        title: "Potential Performance Bottleneck",
                        description: "The /api/users endpoint shows increasing response times during peak hours.",
                        severity: "warning",
                        created: new Date(Date.now() - 86400000).toISOString()
                    },
                    {
                        id: 3,
                        title: "Error Rate Spike",
                        description: "Detected an increase in error rates for POST /api/orders in the last 24 hours.",
                        severity: "critical",
                        created: new Date(Date.now() - 43200000).toISOString()
                    },
                    {
                        id: 4,
                        title: "Caching Recommendation",
                        description: "Enable caching for GET /api/products to reduce database load and improve response times.",
                        severity: "suggestion",
                        created: new Date(Date.now() - 172800000).toISOString()
                    },
                    {
                        id: 5,
                        title: "Architecture Improvement",
                        description: "Consider implementing rate limiting for authentication endpoints to prevent brute force attacks.",
                        severity: "suggestion",
                        created: new Date(Date.now() - 259200000).toISOString()
                    }
                ];
                
                const severityColors = {
                    info: "#3498db",
                    warning: "#f39c12",
                    critical: "#e74c3c",
                    suggestion: "#2ecc71"
                };
                
                const handleGenerateInsights = () => {
                    setLoading(true);
                    
                    // Simulate API call
                    setTimeout(() => {
                        setLoading(false);
                        alert("New AI insights generated based on recent system activity.");
                    }, 2000);
                };
                
                return (
                    <div>
                        <div className="endpoints-header">
                            <div className="chart-title">AI-Powered Insights</div>
                            <button
                                onClick={handleGenerateInsights}
                                style={{
                                    padding: '8px 16px',
                                    borderRadius: '6px',
                                    background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                                    border: 'none',
                                    color: '#fff',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}
                                disabled={loading}
                            >
                                {loading ? (
                                    <>
                                        <span className="connecting" style={{
                                            display: 'inline-block',
                                            width: '16px',
                                            height: '16px',
                                            borderRadius: '50%',
                                            border: '2px solid rgba(255,255,255,0.3)',
                                            borderTopColor: '#fff',
                                            animation: 'spin 1s linear infinite'
                                        }}></span>
                                        Processing...
                                    </>
                                ) : (
                                    <>
                                        <span style={{ fontSize: '1.2em' }}>🤖</span>
                                        Generate New Insights
                                    </>
                                )}
                            </button>
                        </div>
                        
                        <div style={{ display: 'grid', gridTemplateColumns: selectedInsight ? '1fr 2fr' : '1fr', gap: '20px' }}>
                            <div className="insights-list" style={{ 
                                background: '#1a1a1a',
                                borderRadius: '12px',
                                border: '1px solid #333',
                                overflow: 'hidden'
                            }}>
                                {insights.map((insight) => (
                                    <div 
                                        key={insight.id}
                                        onClick={() => setSelectedInsight(insight)}
                                        style={{
                                            padding: '16px 20px',
                                            borderBottom: '1px solid #333',
                                            cursor: 'pointer',
                                            background: selectedInsight?.id === insight.id ? '#2a2a2a' : 'transparent',
                                            borderLeft: selectedInsight?.id === insight.id ? `3px solid ${severityColors[insight.severity]}` : '3px solid transparent',
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                            <div style={{ display: 'flex', alignItems: 'center' }}>
                                                <span style={{ 
                                                    width: '10px', 
                                                    height: '10px', 
                                                    borderRadius: '50%', 
                                                    background: severityColors[insight.severity],
                                                    display: 'inline-block',
                                                    marginRight: '8px'
                                                }}></span>
                                                <span style={{ fontWeight: 'bold' }}>{insight.title}</span>
                                            </div>
                                            <span style={{ fontSize: '0.85em', color: '#888' }}>
                                                {new Date(insight.created).toLocaleDateString()}
                                            </span>
                                        </div>
                                        <div style={{ color: '#bbb', fontSize: '0.9em', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis' }}>
                                            {insight.description}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            {selectedInsight && (
                                <div style={{
                                    background: '#1a1a1a',
                                    borderRadius: '12px',
                                    border: '1px solid #333',
                                    padding: '20px'
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                                        <div>
                                            <h2 style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                                                <span style={{ 
                                                    width: '12px', 
                                                    height: '12px', 
                                                    borderRadius: '50%', 
                                                    background: severityColors[selectedInsight.severity],
                                                    display: 'inline-block'
                                                }}></span>
                                                {selectedInsight.title}
                                            </h2>
                                            <div style={{ color: '#888', marginTop: '5px' }}>
                                                Generated on {new Date(selectedInsight.created).toLocaleString()}
                                            </div>
                                        </div>
                                        <span style={{ 
                                            padding: '5px 10px', 
                                            borderRadius: '12px', 
                                            background: `${severityColors[selectedInsight.severity]}22`, 
                                            color: severityColors[selectedInsight.severity],
                                            textTransform: 'uppercase',
                                            fontWeight: 'bold',
                                            fontSize: '0.8em'
                                        }}>
                                            {selectedInsight.severity}
                                        </span>
                                    </div>
                                    
                                    <div style={{ marginBottom: '20px', lineHeight: '1.6', color: '#ddd' }}>
                                        <p>{selectedInsight.description}</p>
                                        
                                        {selectedInsight.severity === "warning" && (
                                            <>
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Analysis</h3>
                                                <p>The /api/users endpoint is experiencing increased response times, especially during peak hours (10:00 AM - 2:00 PM). Average response time has increased from 85ms to 320ms during these hours.</p>
                                                
                                                <div style={{ height: '200px', margin: '20px 0' }}>
                                                    <canvas></canvas>
                                                </div>
                                                
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Recommendations</h3>
                                                <ul style={{ paddingLeft: '20px' }}>
                                                    <li>Implement pagination to reduce the payload size</li>
                                                    <li>Add index on frequently queried fields</li>
                                                    <li>Consider caching results with a TTL of 60 seconds</li>
                                                </ul>
                                            </>
                                        )}
                                        
                                        {selectedInsight.severity === "critical" && (
                                            <>
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Error Details</h3>
                                                <p>Error rate increased from 0.5% to 12.8% in the last 24 hours. Most common error is HTTP 500 with "Database connection timeout" message.</p>
                                                
                                                <div style={{ marginTop: '20px', background: '#151515', padding: '15px', borderRadius: '8px', fontFamily: 'monospace', fontSize: '0.9em' }}>
                                                    <pre style={{ margin: 0, whiteSpace: 'pre-wrap' }}>
                                                        {`Error: Database connection timeout
at PostgresClient.connect (db.js:143:23)
at OrderController.createOrder (controllers/orders.js:28:12)
at async Router.post (routes/api.js:56:18)`}
                                                    </pre>
                                                </div>
                                                
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Immediate Actions</h3>
                                                <ul style={{ paddingLeft: '20px' }}>
                                                    <li>Check database connection pool settings</li>
                                                    <li>Verify database server load and resources</li>
                                                    <li>Implement retry logic with exponential backoff</li>
                                                    <li>Add circuit breaker to prevent cascading failures</li>
                                                </ul>
                                            </>
                                        )}
                                        
                                        {selectedInsight.severity === "suggestion" && (
                                            <>
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Benefits</h3>
                                                <ul style={{ paddingLeft: '20px' }}>
                                                    <li>Reduce database load by up to 45%</li>
                                                    <li>Improve average response time by 70%</li>
                                                    <li>Better user experience due to faster load times</li>
                                                </ul>
                                                
                                                <h3 style={{ marginTop: '20px', marginBottom: '10px', color: '#bbb' }}>Implementation</h3>
                                                
                                                <div style={{ marginTop: '20px', background: '#151515', padding: '15px', borderRadius: '8px', fontFamily: 'monospace', fontSize: '0.9em' }}>
                                                    <pre style={{ margin: 0, whiteSpace: 'pre-wrap' }}>
                                                        {`// Add the following configuration to enable caching
{
  "path": "/api/products",
  "method": "GET",
  "cache": {
    "enabled": true,
    "ttl": 300,
    "max_size": 1000,
    "vary_by": ["query", "user_role"]
  }
}`}
                                                    </pre>
                                                </div>
                                            </>
                                        )}
                                    </div>
                                    
                                    <div style={{ display: 'flex', gap: '10px', marginTop: '20px' }}>
                                        {selectedInsight.severity === "critical" && (
                                            <button style={{
                                                padding: '8px 16px',
                                                borderRadius: '6px',
                                                background: '#e74c3c',
                                                border: 'none',
                                                color: '#fff',
                                                cursor: 'pointer'
                                            }}>
                                                Fix Immediately
                                            </button>
                                        )}
                                        
                                        {selectedInsight.severity === "suggestion" && (
                                            <button style={{
                                                padding: '8px 16px',
                                                borderRadius: '6px',
                                                background: '#2ecc71',
                                                border: 'none',
                                                color: '#fff',
                                                cursor: 'pointer'
                                            }}>
                                                Apply Suggestion
                                            </button>
                                        )}
                                        
                                        <button style={{
                                            padding: '8px 16px',
                                            borderRadius: '6px',
                                            background: 'rgba(255,255,255,0.1)',
                                            border: '1px solid #444',
                                            color: '#fff',
                                            cursor: 'pointer'
                                        }}>
                                            Ignore
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };
            
            const renderArchitecture = () => {
                const [selectedNode, setSelectedNode] = useState(null);
                const [viewMode, setViewMode] = useState('diagram'); // 'diagram' or 'list'
                const [searchTerm, setSearchTerm] = useState('');
                
                const nodeColors = {
                    endpoint: '#667eea',
                    database: '#00aa44',
                    service: '#ff8800',
                    external: '#cc0000',
                    runtime: '#0066cc',
                    default: '#9966cc'
                };
                
                const getNodeColor = (nodeType) => {
                    return nodeColors[nodeType] || nodeColors.default;
                };
                
                const nodeElements = architecture.nodes.map(node => ({
                    id: node.id,
                    type: 'default',
                    data: { label: node.label, nodeType: node.node_type },
                    position: node.position || { x: 0, y: 0 },
                    style: {
                        background: getNodeColor(node.node_type),
                        color: 'white',
                        border: '1px solid #555',
                        borderRadius: '6px',
                        padding: '10px 15px',
                        width: 'auto',
                    }
                }));
                
                const edgeElements = architecture.edges.map(edge => ({
                    id: edge.id,
                    source: edge.source,
                    target: edge.target,
                    animated: edge.type === 'data_flow',
                    style: { stroke: '#aaa' }
                }));
                
                const elements = [...nodeElements, ...edgeElements];
                
                const handleNodeClick = (node) => {
                    const selectedNodeData = architecture.nodes.find(n => n.id === node.id);
                    if (selectedNodeData) {
                        setSelectedNode(selectedNodeData);
                    }
                };
                
                return (
                    <div>
                        <div className="chart-container" style={{ marginBottom: '20px' }}>
                            <div className="chart-title">System Architecture</div>
                            <div className="architecture-view">
                                {architecture.nodes.length === 0 ? (
                                    <div className="loading">No architecture data available</div>
                                ) : (
                                    <div style={{ padding: '20px' }}>
                                        <div style={{ 
                                            display: 'flex', 
                                            marginBottom: '20px',
                                            padding: '15px',
                                            background: '#222',
                                            borderRadius: '8px',
                                            flexWrap: 'wrap',
                                            gap: '10px'
                                        }}>
                                            {Object.entries(nodeColors).map(([type, color]) => (
                                                <div key={type} style={{ 
                                                    display: 'flex', 
                                                    alignItems: 'center',
                                                    marginRight: '15px' 
                                                }}>
                                                    <div style={{ 
                                                        width: '12px', 
                                                        height: '12px', 
                                                        background: color,
                                                        marginRight: '6px',
                                                        borderRadius: '3px'
                                                    }}></div>
                                                    <span style={{ textTransform: 'capitalize' }}>{type}</span>
                                                </div>
                                            ))}
                                        </div>
                                        
                                        <div style={{ 
                                            display: 'grid',
                                            gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
                                            gap: '15px'
                                        }}>
                                            {architecture.nodes.map(node => (
                                                <div 
                                                    key={node.id} 
                                                    style={{ 
                                                        padding: '15px',
                                                        border: '1px solid #444',
                                                        borderRadius: '8px',
                                                        borderLeft: `4px solid ${getNodeColor(node.node_type)}`,
                                                        backgroundColor: selectedNode && selectedNode.id === node.id ? '#222' : '#1a1a1a',
                                                        cursor: 'pointer'
                                                    }}
                                                    onClick={() => setSelectedNode(node)}
                                                >
                                                    <div style={{ 
                                                        display: 'flex', 
                                                        justifyContent: 'space-between', 
                                                        alignItems: 'center',
                                                        marginBottom: '8px'
                                                    }}>
                                                        <strong style={{ fontSize: '16px' }}>{node.label}</strong>
                                                        <span style={{ 
                                                            fontSize: '12px', 
                                                            textTransform: 'uppercase',
                                                            backgroundColor: getNodeColor(node.node_type),
                                                            color: 'white',
                                                            padding: '3px 6px',
                                                            borderRadius: '4px'
                                                        }}>
                                                            {node.node_type}
                                                        </span>
                                                    </div>
                                                    
                                                    <div style={{ fontSize: '14px', color: '#bbb' }}>
                                                        {node.description || `${node.node_type} component`}
                                                    </div>
                                                    
                                                    <div style={{ 
                                                        marginTop: '10px',
                                                        fontSize: '13px',
                                                        color: '#888' 
                                                    }}>
                                                        Connections: {architecture.edges.filter(
                                                            e => e.source === node.id || e.target === node.id
                                                        ).length}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                        
                        {selectedNode && (
                            <div className="chart-container">
                                <div className="chart-title">
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                        <span>Node Details: {selectedNode.label}</span>
                                        <button 
                                            onClick={() => setSelectedNode(null)}
                                            style={{
                                                background: 'none',
                                                border: 'none',
                                                color: '#888',
                                                fontSize: '1.5em',
                                                cursor: 'pointer'
                                            }}
                                        >×</button>
                                    </div>
                                </div>
                                
                                <div style={{ padding: '20px' }}>
                                    <div style={{ 
                                        display: 'grid',
                                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                                        gap: '15px',
                                        marginBottom: '20px'
                                    }}>
                                        <div className="metric-card" style={{ margin: 0 }}>
                                            <div className="metric-title">Type</div>
                                            <div className="metric-value" style={{ 
                                                color: getNodeColor(selectedNode.node_type),
                                                textTransform: 'capitalize'
                                            }}>
                                                {selectedNode.node_type}
                                            </div>
                                        </div>
                                        
                                        <div className="metric-card" style={{ margin: 0 }}>
                                            <div className="metric-title">Status</div>
                                            <div className="metric-value" style={{ 
                                                color: selectedNode.status === 'active' ? '#00aa44' : '#cc0000',
                                            }}>
                                                {selectedNode.status || 'Active'}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style={{ 
                                        background: '#151515',
                                        border: '1px solid #333',
                                        borderRadius: '8px',
                                        padding: '15px',
                                        marginBottom: '20px'
                                    }}>
                                        <h3 style={{ marginBottom: '10px', color: '#bbb' }}>Connected Components</h3>
                                        <div>
                                            {architecture.edges
                                                .filter(e => e.source === selectedNode.id || e.target === selectedNode.id)
                                                .map((edge, index) => {
                                                    const connectedNodeId = edge.source === selectedNode.id ? edge.target : edge.source;
                                                    const connectedNode = architecture.nodes.find(n => n.id === connectedNodeId);
                                                    const isOutgoing = edge.source === selectedNode.id;
                                                    
                                                    if (!connectedNode) return null;
                                                    
                                                    return (
                                                        <div key={index} style={{ 
                                                            padding: '10px 0',
                                                            borderBottom: index < architecture.edges.length - 1 ? '1px solid #333' : 'none',
                                                            display: 'flex',
                                                            alignItems: 'center'
                                                        }}>
                                                            {isOutgoing ? '→ ' : '← '}
                                                            <span style={{ 
                                                                display: 'inline-block',
                                                                width: '10px',
                                                                height: '10px',
                                                                backgroundColor: getNodeColor(connectedNode.node_type),
                                                                marginRight: '8px',
                                                                borderRadius: '50%'
                                                            }}></span>
                                                            <span style={{ fontWeight: 500 }}>{connectedNode.label}</span>
                                                            <span style={{ 
                                                                marginLeft: '8px', 
                                                                color: '#888',
                                                                fontSize: '13px'
                                                            }}>
                                                                ({connectedNode.node_type})
                                                            </span>
                                                            <span style={{ 
                                                                marginLeft: 'auto', 
                                                                fontSize: '13px',
                                                                color: '#666'
                                                            }}>
                                                                {edge.type || 'connection'}
                                                            </span>
                                                        </div>
                                                    );
                                                })}
                                                
                                            {architecture.edges.filter(e => 
                                                e.source === selectedNode.id || e.target === selectedNode.id
                                            ).length === 0 && (
                                                <div style={{ color: '#888', padding: '10px 0' }}>
                                                    No connections found
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                    
                                    {selectedNode.config && (
                                        <div style={{ marginTop: '20px' }}>
                                            <h3 style={{ marginBottom: '10px', color: '#bbb' }}>Configuration</h3>
                                            <div style={{ 
                                                background: '#151515', 
                                                border: '1px solid #333',
                                                borderRadius: '8px',
                                                padding: '12px',
                                                fontFamily: 'monospace',
                                                fontSize: '14px',
                                                color: '#aaa',
                                                maxHeight: '200px',
                                                overflow: 'auto'
                                            }}>
                                                {JSON.stringify(selectedNode.config, null, 2)}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            const [settings, setSettings] = useState({
                theme: 'dark',
                notifications: true,
                autoRefresh: true,
                refreshInterval: 10 // seconds
            });
            
            const [showSettings, setShowSettings] = useState(false);
            
            const toggleTheme = () => {
                const newTheme = settings.theme === 'dark' ? 'light' : 'dark';
                setSettings({...settings, theme: newTheme});
                document.documentElement.setAttribute('data-theme', newTheme);
                // Apply theme changes to the DOM
                applyTheme(newTheme);
            };
            
            // Function to apply theme changes
            const applyTheme = (theme) => {
                const root = document.documentElement;
                if (theme === 'dark') {
                    root.style.setProperty('--bg-color', '#0f0f0f');
                    root.style.setProperty('--text-color', '#ffffff');
                    root.style.setProperty('--card-bg', '#1a1a1a');
                    root.style.setProperty('--border-color', '#333');
                    root.style.setProperty('--hover-color', '#222');
                    root.style.setProperty('--sidebar-bg', '#1a1a1a');
                    root.style.setProperty('--main-bg', '#111');
                    root.style.setProperty('--panel-bg', '#1a1a1a');
                    root.style.setProperty('--panel-header-bg', '#222');
                    root.style.setProperty('--notification-bg', '#222');
                    root.style.setProperty('--dropdown-bg', '#222');
                    root.style.setProperty('--dropdown-hover', '#333');
                    root.style.setProperty('--muted-text', '#888');
                    root.style.setProperty('--button-hover', 'rgba(255,255,255,0.1)');
                } else {
                    root.style.setProperty('--bg-color', '#f5f5f5');
                    root.style.setProperty('--text-color', '#333333');
                    root.style.setProperty('--card-bg', '#ffffff');
                    root.style.setProperty('--border-color', '#e0e0e0');
                    root.style.setProperty('--hover-color', '#f0f0f0');
                    root.style.setProperty('--sidebar-bg', '#f0f0f0');
                    root.style.setProperty('--main-bg', '#f9f9f9');
                    root.style.setProperty('--panel-bg', '#ffffff');
                    root.style.setProperty('--panel-header-bg', '#f0f0f0');
                    root.style.setProperty('--notification-bg', '#ffffff');
                    root.style.setProperty('--dropdown-bg', '#ffffff');
                    root.style.setProperty('--dropdown-hover', '#f5f5f5');
                    root.style.setProperty('--muted-text', '#666');
                    root.style.setProperty('--button-hover', 'rgba(0,0,0,0.05)');
                }
                
                // Apply theme to all charts
                const updateCharts = () => {
                    Chart.defaults.color = theme === 'dark' ? '#aaa' : '#666';
                    Chart.defaults.borderColor = theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
                    
                    // Force all charts to update
                    Chart.instances.forEach(chart => {
                        // Update grid and text colors
                        if (chart.options.scales) {
                            Object.values(chart.options.scales).forEach(scale => {
                                if (scale.grid) scale.grid.color = theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';
                                if (scale.ticks) scale.ticks.color = theme === 'dark' ? '#999' : '#666';
                            });
                        }
                        
                        // Update legend colors
                        if (chart.options.plugins && chart.options.plugins.legend) {
                            chart.options.plugins.legend.labels.color = theme === 'dark' ? '#ddd' : '#333';
                        }
                        
                        chart.update();
                    });
                };
                
                // Update charts on next tick to ensure they've been initialized
                setTimeout(updateCharts, 0);
            };
            
            const toggleSettings = () => {
                setShowSettings(!showSettings);
                if (showNotifications) setShowNotifications(false);
            };
            
            // Already defined above
            
            const NotificationPanel = () => {
                return (
                    <div className={`notification-panel ${showNotifications ? 'show' : ''}`}>
                        <div className="notification-panel-header">
                            <h3>Notifications</h3>
                            <div className="notification-actions">
                                {notifications.length > 0 && (
                                    <button 
                                        className="clear-all-btn" 
                                        onClick={() => setNotifications([])}
                                    >
                                        Clear All
                                    </button>
                                )}
                                <button onClick={toggleNotifications}>×</button>
                            </div>
                        </div>
                        <div className="notification-panel-content">
                            {notifications.length === 0 ? (
                                <div className="empty-notifications">
                                    <p>No notifications</p>
                                </div>
                            ) : (
                                <div className="notification-list">
                                    {notifications.map(notification => (
                                        <div 
                                            key={notification.id} 
                                            className={`notification-item ${notification.type}`}
                                        >
                                            <div className="notification-icon">
                                                {notification.type === 'success' && '✓'}
                                                {notification.type === 'error' && '✗'}
                                                {notification.type === 'warning' && '⚠'}
                                                {notification.type === 'info' && 'ℹ'}
                                            </div>
                                            <div className="notification-content">
                                                <div className="notification-title">{notification.title}</div>
                                                <div className="notification-message">{notification.message}</div>
                                                <div className="notification-time">
                                                    {new Date(notification.timestamp).toLocaleTimeString()}
                                                </div>
                                            </div>
                                            <button 
                                                className="notification-close" 
                                                onClick={() => removeNotification(notification.id)}
                                            >
                                                ×
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            return (
                <div className="dashboard">
                    <div className="header">
                        <div className="logo">⚡ Backworks</div>
                        
                        <div className="nav-buttons" style={{ marginLeft: '40px', display: 'flex', gap: '5px' }}>
                            <button 
                                style={{
                                    background: 'rgba(255,255,255,0.1)',
                                    border: 'none',
                                    borderRadius: '4px',
                                    color: '#fff',
                                    padding: '5px 10px',
                                    fontSize: '14px',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '5px'
                                }}
                            >
                                📊 Dashboard
                            </button>
                            <button 
                                style={{
                                    background: 'transparent',
                                    border: 'none',
                                    borderRadius: '4px',
                                    color: '#ccc',
                                    padding: '5px 10px',
                                    fontSize: '14px',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '5px'
                                }}
                            >
                                🔧 Settings
                            </button>
                            <button 
                                style={{
                                    background: 'transparent',
                                    border: 'none',
                                    borderRadius: '4px',
                                    color: '#ccc',
                                    padding: '5px 10px',
                                    fontSize: '14px',
                                    cursor: 'pointer',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '5px'
                                }}
                            >
                                📚 Docs
                            </button>
                        </div>
                        
                        <div className="header-actions" style={{ marginLeft: 'auto', display: 'flex', gap: '15px', alignItems: 'center' }}>
                            <button
                                onClick={toggleTheme}
                                style={{
                                    background: 'rgba(255,255,255,0.1)',
                                    border: 'none',
                                    borderRadius: '50%',
                                    width: '32px',
                                    height: '32px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    cursor: 'pointer',
                                    color: '#fff',
                                    fontSize: '16px'
                                }}
                                title={`Switch to ${settings.theme === 'dark' ? 'light' : 'dark'} mode`}
                            >
                                {settings.theme === 'dark' ? '🌙' : '☀️'}
                            </button>
                            
                            <button
                                onClick={toggleNotifications}
                                style={{
                                    background: 'rgba(255,255,255,0.1)',
                                    border: 'none',
                                    borderRadius: '50%',
                                    width: '32px',
                                    height: '32px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    cursor: 'pointer',
                                    color: '#fff',
                                    fontSize: '16px',
                                    position: 'relative'
                                }}
                                title="Notifications"
                            >
                                🔔
                                {notifications.length > 0 && (
                                    <span className="notification-badge">{notifications.length > 9 ? '9+' : notifications.length}</span>
                                )}
                            </button>
                            
                            <button
                                onClick={toggleSettings}
                                style={{
                                    background: 'rgba(255,255,255,0.1)',
                                    border: 'none',
                                    borderRadius: '50%',
                                    width: '32px',
                                    height: '32px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    cursor: 'pointer',
                                    color: '#fff',
                                    fontSize: '16px'
                                }}
                                title="Settings"
                            >
                                ⚙️
                            </button>
                            
                            <div className="status">
                                <div className={`status-dot ${connected ? '' : 'connecting'}`}></div>
                                <span>{connected ? 'Live Data' : 'Demo Mode'}</span>
                            </div>
                        </div>
                    </div>

                    <div className="sidebar">
                        <div 
                            className={`nav-item ${activeTab === 'overview' ? 'active' : ''}`}
                            onClick={() => setActiveTab('overview')}
                        >
                            📊 Overview
                        </div>
                        <div 
                            className={`nav-item ${activeTab === 'endpoints' ? 'active' : ''}`}
                            onClick={() => setActiveTab('endpoints')}
                        >
                            🔗 Endpoints
                        </div>
                        <div 
                            className={`nav-item ${activeTab === 'monitoring' ? 'active' : ''}`}
                            onClick={() => setActiveTab('monitoring')}
                        >
                            📈 Real-time Monitor
                        </div>
                        <div 
                            className={`nav-item ${activeTab === 'architecture' ? 'active' : ''}`}
                            onClick={() => setActiveTab('architecture')}
                        >
                            🏗️ Architecture
                        </div>
                        <div 
                            className={`nav-item ${activeTab === 'ai' ? 'active' : ''}`}
                            onClick={() => setActiveTab('ai')}
                        >
                            🤖 AI Insights
                        </div>
                    </div>

                    <div className="main-content">
                        {error && <div className="error">{error}</div>}
                        
                        {activeTab === 'overview' && renderOverview()}
                        {activeTab === 'endpoints' && renderEndpoints()}
                        {activeTab === 'monitoring' && renderMonitoring()}
                        {activeTab === 'architecture' && renderArchitecture()}
                        {activeTab === 'ai' && renderAIInsights()}
                    </div>
                    
                    {/* Settings Panel */}
                    {showSettings && (
                        <div className="settings-panel">
                            <div className="settings-panel-header">
                                <h3 style={{ margin: 0 }}>Settings</h3>
                                <button 
                                    onClick={toggleSettings}
                                    style={{
                                        background: 'none',
                                        border: 'none',
                                        color: '#888',
                                        fontSize: '20px',
                                        cursor: 'pointer',
                                        padding: '0 5px'
                                    }}
                                >×</button>
                            </div>
                            <div className="settings-panel-content">
                                <div className="settings-row">
                                    <div>
                                        <div style={{ fontWeight: 'bold' }}>Dark Theme</div>
                                        <div style={{ fontSize: '12px', color: '#888' }}>Switch between dark and light mode</div>
                                    </div>
                                    <label className="toggle-switch">
                                        <input 
                                            type="checkbox" 
                                            checked={settings.theme === 'dark'} 
                                            onChange={toggleTheme} 
                                        />
                                        <span className="toggle-slider"></span>
                                    </label>
                                </div>
                                
                                <div className="settings-row">
                                    <div>
                                        <div style={{ fontWeight: 'bold' }}>Notifications</div>
                                        <div style={{ fontSize: '12px', color: '#888' }}>Enable alert notifications</div>
                                    </div>
                                    <label className="toggle-switch">
                                        <input 
                                            type="checkbox" 
                                            checked={settings.notifications} 
                                            onChange={() => setSettings({...settings, notifications: !settings.notifications})} 
                                        />
                                        <span className="toggle-slider"></span>
                                    </label>
                                </div>
                                
                                <div className="settings-row">
                                    <div>
                                        <div style={{ fontWeight: 'bold' }}>Auto Refresh</div>
                                        <div style={{ fontSize: '12px', color: '#888' }}>Refresh data automatically</div>
                                    </div>
                                    <label className="toggle-switch">
                                        <input 
                                            type="checkbox" 
                                            checked={settings.autoRefresh} 
                                            onChange={() => setSettings({...settings, autoRefresh: !settings.autoRefresh})} 
                                        />
                                        <span className="toggle-slider"></span>
                                    </label>
                                </div>
                                
                                {settings.autoRefresh && (
                                    <div className="settings-row">
                                        <div>
                                            <div style={{ fontWeight: 'bold' }}>Refresh Interval</div>
                                            <div style={{ fontSize: '12px', color: '#888' }}>Time between refreshes (seconds)</div>
                                        </div>
                                        <input 
                                            type="number" 
                                            value={settings.refreshInterval}
                                            min="5"
                                            max="60"
                                            onChange={(e) => setSettings({...settings, refreshInterval: parseInt(e.target.value)})}
                                            style={{
                                                background: '#2a2a2a',
                                                border: '1px solid #444',
                                                padding: '5px 8px',
                                                borderRadius: '4px',
                                                color: '#fff',
                                                width: '60px'
                                            }}
                                        />
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                    
                    {/* Notification Panel */}
                    {showNotifications && (
                        <NotificationPanel />
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('app'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
